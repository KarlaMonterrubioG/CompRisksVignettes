<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Karla Monterrubio-Gómez, Nathan Constantine-Cooke, and Catalina Vallejos" />

<meta name="date" content="2023-08-22" />

<title>Data exploration</title>

<script src="DataPreparation_files/header-attrs-2.23/header-attrs.js"></script>
<script src="DataPreparation_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="DataPreparation_files/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="DataPreparation_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="DataPreparation_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="DataPreparation_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="DataPreparation_files/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="DataPreparation_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="DataPreparation_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="DataPreparation_files/navigation-1.1/tabsets.js"></script>
<script src="DataPreparation_files/navigation-1.1/codefolding.js"></script>
<link href="DataPreparation_files/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="DataPreparation_files/highlightjs-9.12.0/highlight.js"></script>
<script src="https://kit.fontawesome.com/1339b11c04.js" crossorigin="anonymous"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id = "nav">
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="DataPreparation.html">Data Preparation</a></li>
    <li><a href="CIF_specification.html">Cumulative Incidence</a></li>
    <li><a href="CS_specification.html">Cause Specific</a></li>
    <li><a href="Discrete_specification.html">Discrete</a></li>
    <li><a href="Others.html">Other</a></li>
    <li><a href="Predictions.html">Predictions</a></li>
    <li style="float:right"><a href="https://github.com/VallejosGroup/CompRisksVignettes"><i style="font-size: 20px; padding-top: 0px; padding-bottom: 0px;" class="fa-brands fa-github"></i></a></li>
  </ul>
</div>

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data exploration</h1>
<h4 class="author">Karla Monterrubio-Gómez, Nathan Constantine-Cooke,
and Catalina Vallejos</h4>
<h4 class="date">2023-08-22</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>To demonstrate the usage of difference competing risks survival
methods, we use publicly available data.</p>
<p>The code below is used to load and pre-process the data.
Additionally, we randomly split the data into <em>training</em> and
<em>testing</em> sets as that will allow us to evaluate out-of-sample
predictive performance when comparing different approaches.</p>
<p>To avoid code duplication, a basic version of the code below is
stored as an R file which will be sourced at the start of each
vignette.</p>
</div>
<div id="data-preparation" class="section level1">
<h1>Data preparation</h1>
<p>The dataset used here corresponds to the Hodgkin’s disease (HD) study
described in Pintilie, 2006. The dataset comprises 865 patients
diagnosed with early stage (I or II) HD, and which were treated either
with radiation (RT) or with radiation and chemotherapy (CMT).</p>
<p>The recorded data includes:</p>
<ul>
<li>age: Age (years)</li>
<li>sex: Sex, F=female and M=Male.</li>
<li>trtgiven: Treatment given, RT=Radiation, CMT=Chemotherapy and
radiation</li>
<li>medwidsi: Size of mediastinum involvement, N=No, S=Small,
L=Large</li>
<li>extranod: Extranodal disease, Y=Extranodal disease, N= Nodal
disease</li>
<li>clinstg: Clinical stage, 1=Stage I, 2=Stage II</li>
<li>time: time to failure (years) calculated from the date of
diagnosis</li>
<li>status: 0=censoring, 1=relapse and 2=death.</li>
</ul>
<p>We now load and display the structure of the HD dataset:</p>
<pre class="r"><code>require(readr)
hd &lt;- data.frame(read_csv(&quot;../Data/HD/hd.csv&quot;,
                          col_types = cols(X1 = col_skip())))
str(hd)
#&gt; &#39;data.frame&#39;:    865 obs. of  8 variables:
#&gt;  $ age     : num  64 63 17 63 21 37 41 35 27 32 ...
#&gt;  $ sex     : chr  &quot;F&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; ...
#&gt;  $ trtgiven: chr  &quot;RT&quot; &quot;RT&quot; &quot;RT&quot; &quot;RT&quot; ...
#&gt;  $ medwidsi: chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
#&gt;  $ extranod: chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
#&gt;  $ clinstg : num  1 1 2 2 2 1 2 2 2 2 ...
#&gt;  $ time    : num  3.1 15.9 0.9 13.1 35.9 1.1 2.5 0.003 4.1 28.1 ...
#&gt;  $ status  : num  2 2 1 2 0 1 1 1 1 0 ...</code></pre>
<p>To procede with the analysis, it is important to change the data type
of sex, trtgiven, medwidsi, and extranod from <code>character</code> to
<code>factor</code>. Similarly, we convert clinstg from
<code>numeric</code> to <code>factor</code>.</p>
<pre class="r"><code>hd$sex      &lt;- as.factor(hd$sex)
hd$trtgiven &lt;- as.factor(hd$trtgiven)
hd$medwidsi &lt;- as.factor(hd$medwidsi)
hd$extranod &lt;- as.factor(hd$extranod)
hd$clinstg  &lt;- as.factor(hd$clinstg)</code></pre>
</div>
<div id="data-exploration" class="section level1">
<h1>Data exploration</h1>
<p>Now, we explore the number of events for each event type:</p>
<pre class="r"><code>require(pander)
pander::pander(table(hd$status))</code></pre>
<table style="width:25%;">
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">439</td>
<td align="center">291</td>
<td align="center">135</td>
</tr>
</tbody>
</table>
<p>Thus, we have 439 censored patients, 291 with relapse and 135 who
died. From now on, we assume that the event of interest is relapse,
i.e. <code>status=1</code>.</p>
<p>In order to create a test set, we use stratified sampling to
partition our data in 80% for train and 20% for test.</p>
<pre class="r"><code>require(splitstackshape)
#&gt; Loading required package: splitstackshape
set.seed(2022)
split_data &lt;- stratified(hd, c(&quot;status&quot;), 0.8, bothSets = TRUE)
hd_train   &lt;- split_data$SAMP1
hd_test    &lt;- split_data$SAMP2</code></pre>
<p>Now, we explore the number of observations per status in both train
and test set:</p>
<pre class="r"><code>pander::pander(table(hd_train$status))</code></pre>
<table style="width:25%;">
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">351</td>
<td align="center">233</td>
<td align="center">108</td>
</tr>
</tbody>
</table>
<pre class="r"><code>pander::pander(table(hd_test$status))</code></pre>
<table style="width:21%;">
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">88</td>
<td align="center">58</td>
<td align="center">27</td>
</tr>
</tbody>
</table>
<p>To</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div id="refs">

</div>
</div>
<div id="session-info" class="section level1">
<h1>Session Info</h1>
<pre class="r"><code>sessionInfo()
#&gt; R version 4.3.0 (2023-04-21)
#&gt; Platform: aarch64-apple-darwin20 (64-bit)
#&gt; Running under: macOS Ventura 13.2.1
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0
#&gt; 
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; time zone: Europe/London
#&gt; tzcode source: internal
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt; [1] splitstackshape_1.4.8 pander_0.6.5          readr_2.1.4          
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] crayon_1.5.2      vctrs_0.6.3       cli_3.6.1         knitr_1.43       
#&gt;  [5] rlang_1.1.1       xfun_0.39         data.table_1.14.8 jsonlite_1.8.7   
#&gt;  [9] bit_4.0.5         glue_1.6.2        htmltools_0.5.5   sass_0.4.7       
#&gt; [13] hms_1.1.3         fansi_1.0.4       rmarkdown_2.23    evaluate_0.21    
#&gt; [17] jquerylib_0.1.4   tibble_3.2.1      tzdb_0.4.0        fastmap_1.1.1    
#&gt; [21] yaml_2.3.7        lifecycle_1.0.3   compiler_4.3.0    codetools_0.2-19 
#&gt; [25] Rcpp_1.0.11       pkgconfig_2.0.3   rstudioapi_0.15.0 digest_0.6.33    
#&gt; [29] R6_2.5.1          tidyselect_1.2.0  utf8_1.2.3        parallel_4.3.0   
#&gt; [33] vroom_1.6.3       pillar_1.9.0      magrittr_2.0.3    bslib_0.5.0      
#&gt; [37] bit64_4.0.5       tools_4.3.0       cachem_1.0.8</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
